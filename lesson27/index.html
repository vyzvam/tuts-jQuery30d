<!doctype html>
<html>
<head>
	<meta charset=utf-8>
	<title>jQuery Deffereds</title>

</head>
<body>


<script src="../jquery-1.7.1.js"></script>

<script>

/*
	This routine below logs the value of myVar after two seconds as per the instruction
	given to the setTimeout function.

	The idea here is to proove that the value assigned in the setTimout only accesible after 
	two seconds regarless where it is accessed, 
	the value can only be accessed :
	  1. Within the function where it will log after assgining the value after 2 seconds or 
	  2. using a pubsub method where we learnt earlier in this tutorial.


var myVar;
setTimeout(function() {
	myVar = 'my value in the setTimeout function';
	console.log(myVar);
}, 2000);
console.log(myVar);


*/

/*
	We will use a deferred to solve the scenario above
*/

var myVar,
	
	//Create a function that will have the deffered object
	setVal = function() {
		//deferred object
		var deferred = $.Deferred();
		setTimeout(function() {
			myVar = 'My Value in timeout';
			// to notifiy that the task is complete
			deferred.resolve();
		}, 2000);

		//to flag this object to inform once it has completed it's task
		return deferred.promise();

	}
;




/*
take note that this method below will only be triggered only when 
the result is "resolved" this would mean calling done() will only execute if the deferred state 
is .resolve();
*/

/*setVal().done(function() {
	console.log('all done ' + myVar);
});


//the function below will execute when the deferred state is reject 
setVal().fail(function() {
	console.log('Failed ' + myVar);
});

//the function below ill execute regardless of the deferred state
setVal().always(function() {
	console.log('Failed ' + myVar);
});
*/

//We can also chain methods above as below

setVal().done(function() {
	console.log('Done: ' + myVar);
}).fail(function() {
	console.log('Failed: ' + myVar);
})













</script>

</body>
</html>